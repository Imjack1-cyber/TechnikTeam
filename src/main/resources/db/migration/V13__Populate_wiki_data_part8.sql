-- Flyway migration V13, Part 8

INSERT INTO `wiki_documentation` (`file_path`, `content`) VALUES
('src/main/java/de/technikteam/model/Role.java', '1.  **File Overview & Purpose**\n\n    This is a simple POJO representing a user role from the `roles` table. It defines a high-level grouping of users (e.g., \"ADMIN\", \"NUTZER\").\n\n2.  **Architectural Role**\n\n    This class is part of the **Model Tier**. It is used by the `RoleDAO` to represent role data and is passed to the `AdminUserServlet` to populate the roles dropdown list.\n\n3.  **Key Dependencies & Libraries**\n\n    *   None. This is a self-contained POJO.\n\n4.  **In-Depth Breakdown**\n\n    *   **Fields:**\n        *   `id`: The primary key of the role.\n        *   `roleName`: The unique name of the role (e.g., \"ADMIN\").\n    *   **Getters and Setters**: Standard methods for property access.'),
('src/main/java/de/technikteam/model/SkillRequirement.java', '1.  **File Overview & Purpose**\n\n    This POJO represents a single skill requirement for an event, corresponding to a record in the `event_skill_requirements` table. It links an event to a specific course (acting as the \"skill\") and specifies how many people with that qualification are needed.\n\n2.  **Architectural Role**\n\n    This class is part of the **Model Tier**. It is used to transfer data about an event''s personnel needs between the `EventDAO`, `EventService`, and the `AdminEventServlet`.\n\n3.  **Key Dependencies & Libraries**\n\n    *   None. This is a self-contained POJO.\n\n4.  **In-Depth Breakdown**\n\n    *   **Fields:**\n        *   `requiredCourseId`: The foreign key ID of the `Course` that represents the required skill.\n        *   `requiredPersons`: The number of people with this skill needed for the event.\n        *   `courseName`: A transient field, populated by a JOIN, to display the name of the required course in the UI.\n    *   **Getters and Setters**: Standard methods for property access.'),
('src/main/java/de/technikteam/model/StorageItem.java', '1.  **File Overview & Purpose**\n\n    This is a comprehensive model representing a single inventory item from the `storage_items` table. It contains all the core data about an item, such as its name, location, and quantities, as well as transient fields and convenience methods for UI display logic.\n\n2.  **Architectural Role**\n\n    This class is a central part of the **Model Tier**. It''s used across all tiers: managed by the `StorageDAO`, manipulated by the `StorageService`, and displayed in various views like `lager.jsp` and `admin_storage_list.jsp`.\n\n3.  **Key Dependencies & Libraries**\n\n    *   None.\n\n4.  **In-Depth Breakdown**\n\n    *   **Core Fields:**\n        *   Maps directly to the columns in the `storage_items` table: `id`, `name`, `location`, `cabinet`, `compartment`, `quantity` (total including defective), `maxQuantity`, `defectiveQuantity`, `defectReason`, `weightKg`, `priceEur`, `imagePath`, `status`, `currentHolderUserId`, `assignedEventId`.\n    *   **Transient UI Fields:**\n        *   `currentHolderUsername`: The name of the user who has checked out the item, populated by a JOIN.\n    *   **Convenience Methods:**\n        *   **`getAvailableQuantity()`**: Calculates the non-defective, available quantity (`quantity` - `defectiveQuantity`). This is a crucial piece of business logic encapsulated within the model.\n        *   **`getAvailabilityStatus()`**: Returns a human-readable status string (\"Vollständig\", \"Niedriger Bestand\", \"Vergriffen\") based on the available quantity relative to the maximum quantity.\n        *   **`getAvailabilityStatusCssClass()`**: Returns a corresponding CSS class (`status-ok`, `status-warn`, `status-danger`) for the availability status, simplifying JSP logic.'),
('src/main/java/de/technikteam/model/StorageLogEntry.java', '1.  **File Overview & Purpose**\n\n    This POJO represents a single transaction log entry from the `storage_log` table. It serves as a historical record of an item being checked in or out of the inventory.\n\n2.  **Architectural Role**\n\n    This class is part of the **Model Tier**. It is created by the `StorageService` to be persisted by the `StorageLogDAO`, and is retrieved by the DAO to be displayed on the `storage_item_details.jsp` page.\n\n3.  **Key Dependencies & Libraries**\n\n    *   `DateFormatter`: Used for the `getFormattedTimestamp()` method.\n    *   `java.time.LocalDateTime` and `DateTimeFormatter`: For handling and formatting the transaction timestamp.\n\n4.  **In-Depth Breakdown**\n\n    *   **Fields:**\n        *   `id`, `itemId`, `userId`, `notes`, `eventId`, `transactionTimestamp`: These map directly to table columns.\n        *   `quantityChange`: An integer representing the change in quantity. It is negative for check-outs and positive for check-ins.\n        *   `username`: A transient field, populated by a JOIN, for displaying the name of the user who performed the transaction.\n    *   **Convenience Methods (`getFormattedTimestamp`, `getTransactionTimestampLocaleString`)**: Provide different formatted string representations of the `transactionTimestamp` for use in the UI.'),
('src/main/java/de/technikteam/model/SystemStatsDTO.java', '1.  **File Overview & Purpose**\n\n    This is a Data Transfer Object (DTO) designed to hold a snapshot of the server''s system-level statistics. It aggregates various metrics like CPU, RAM, and disk usage into a single, clean object for easy serialization and transport to the client.\n\n2.  **Architectural Role**\n\n    This class is part of the **Model Tier**. It is created by the `SystemInfoService` and serialized to JSON by the `SystemStatsApiServlet` to provide real-time data for the admin system status page.\n\n3.  **Key Dependencies & Libraries**\n\n    *   None. This is a self-contained POJO.\n\n4.  **In-Depth Breakdown**\n\n    *   **Fields:**\n        *   `cpuLoad` (double): The system-wide CPU load as a percentage (0.0 - 100.0).\n        *   `totalMemory` (long): Total physical RAM in Gigabytes.\n        *   `usedMemory` (long): Used physical RAM in Gigabytes.\n        *   `totalDiskSpace` (long): Total disk space of the root partition in Gigabytes.\n        *   `usedDiskSpace` (long): Used disk space of the root partition in Gigabytes.\n        *   `uptime` (String): A human-readable string representing the server uptime (e.g., \"5 Tage, 10 Stunden, 3 Minuten\").\n        *   `batteryPercentage` (int): The current battery level as a percentage (0-100), or -1 if not available.\n    *   **Getters and Setters**: Standard methods for property access.'),
('src/main/java/de/technikteam/model/TodoCategory.java', '1.  **File Overview & Purpose**\n\n    This POJO represents a category in the To-Do list feature, corresponding to a record in the `todo_categories` table. It acts as a container for a list of related `TodoTask` objects.\n\n2.  **Architectural Role**\n\n    This class is part of the **Model Tier**. It is used by the `TodoDAO` and `TodoService` to structure the To-Do list data for the `AdminTodoApiServlet`.\n\n3.  **Key Dependencies & Libraries**\n\n    *   `TodoTask`: The model class for the tasks contained within this category.\n    *   `java.util.List`: Used for the `tasks` collection.\n\n4.  **In-Depth Breakdown**\n\n    *   **Fields:**\n        *   `id`: The primary key of the category.\n        *   `name`: The name of the category (e.g., \"Urgent Bugs\", \"Feature Ideas\").\n        *   `displayOrder`: An integer that determines the vertical sorting of categories on the board.\n        *   `tasks` (List<TodoTask>): A list of task objects that belong to this category.\n    *   **Getters and Setters**: Standard methods for property access.'),
('src/main/java/de/technikteam/model/TodoTask.java', '1.  **File Overview & Purpose**\n\n    This POJO represents a single task item in the To-Do list feature, corresponding to a record in the `todo_tasks` table. It contains the task''s content, its completion status, and its display order within its category.\n\n2.  **Architectural Role**\n\n    This class is part of the **Model Tier**. It is used as a child object within the `TodoCategory` model and is managed by the `TodoDAO` and `TodoService`.\n\n3.  **Key Dependencies & Libraries**\n\n    *   None. This is a self-contained POJO.\n\n4.  **In-Depth Breakdown**\n\n    *   **Fields:**\n        *   `id`: The primary key of the task.\n        *   `categoryId`: A foreign key linking the task to its parent `TodoCategory`.\n        *   `content`: The text of the to-do item.\n        *   `isCompleted`: A boolean flag indicating whether the task is done.\n        *   `displayOrder`: An integer that determines the sorting of tasks within a category.\n    *   **Getters and Setters**: Standard methods for property access.'),
('src/main/java/de/technikteam/model/User.java', '1.  **File Overview & Purpose**\n\n    This is the central model representing a user in the application, corresponding to a record in the `users` table. It holds all core profile information, as well as the user''s role and the complete, resolved set of their permissions. It includes a key business logic method `hasAdminAccess()` for authorization checks.\n\n2.  **Architectural Role**\n\n    This is a critical class in the **Model Tier**. A `User` object is stored in the `HttpSession` upon successful login and is accessed by nearly every other component in the application—from filters and servlets for authorization to DAOs for identifying the actor in log entries.\n\n3.  **Key Dependencies & Libraries**\n\n    *   `Permissions`: The constants class is used within the `hasAdminAccess()` method.\n    *   `DateFormatter`: Used by the `getFormattedCreatedAt()` convenience method.\n\n4.  **In-Depth Breakdown**\n\n    *   **Core Fields:**\n        *   `id`, `username`, `roleId`, `createdAt`, `classYear`, `className`, `email`, `chatColor`, `theme`: These map to columns in the `users` table.\n    *   **Aggregated/Transient Fields:**\n        *   `roleName`: The name of the user''s role, populated by a JOIN in the `UserDAO`.\n        *   `permissions` (Set<String>): The complete set of permission keys the user has. This is populated at login time by the `UserDAO` by resolving both direct and role-based permissions.\n    *   **`hasAdminAccess()`**\n        *   **Method Signature:** `public boolean hasAdminAccess()`\n        *   **Purpose:** A crucial piece of business logic encapsulated in the model. It provides a single, reliable way to determine if a user should have access to administrative areas.\n        *   **Logic:** It returns `true` if the user has the master `ACCESS_ADMIN_PANEL` permission, or if they have *any* other permission that implies administrative capabilities (e.g., any `_CREATE`, `_DELETE`, `_MANAGE` permission). This is more flexible than just checking for the \"ADMIN\" role name.\n    *   **`getFormattedCreatedAt()`**: A view-helper method to provide a JSP-ready string for the user''s registration date.\n    *   **Constructors and Getters/Setters**: Includes a default constructor, a convenience constructor, and standard property accessors.'),
('src/main/java/de/technikteam/model/UserQualification.java', '1.  **File Overview & Purpose**\n\n    This POJO represents a user''s qualification, linking a user to a course. It corresponds to a record in the `user_qualifications` table and tracks the user''s status for that course (e.g., \"BESUCHT\", \"ABSOLVIERT\"), the date of completion, and any administrative remarks.\n\n2.  **Architectural Role**\n\n    This class is part of the **Model Tier**. It is used to transfer qualification data between the `UserQualificationsDAO` and the servlets that display this information, such as the `ProfileServlet` and the `MatrixServlet`.\n\n3.  **Key Dependencies & Libraries**\n\n    *   `java.time.LocalDate`: Used for the `completionDate` field.\n\n4.  **In-Depth Breakdown**\n\n    *   **Fields:**\n        *   `userId`: Foreign key to the `users` table.\n        *   `courseId`: Foreign key to the `courses` table.\n        *   `courseName`: A transient field, populated by a JOIN, for displaying the course''s name.\n        *   `status`: An enum-like string indicating the user''s progress in the course.\n        *   `completionDate`: The date on which the user achieved \"ABSOLVIERT\" status.\n        *   `remarks`: Optional administrative notes.\n    *   **Getters and Setters**: Standard methods for property access.'),
('src/main/java/de/technikteam/model/WikiEntry.java', '1.  **File Overview & Purpose**\n\n    This is a simple Plain Old Java Object (POJO) that serves as the data model for a single wiki documentation page. It represents a record from the `wiki_documentation` table.\n\n2.  **Architectural Role**\n\n    This class is part of the **Model Tier**. It is used to transfer wiki data between the `WikiDAO`, the `WikiService`, and the administrative servlets that manage the wiki.\n\n3.  **Key Dependencies & Libraries**\n\n    *   None. This is a self-contained POJO.\n\n4.  **In-Depth Breakdown**\n\n    *   **Fields:**\n        *   `id`: The primary key of the wiki entry.\n        *   `filePath`: A unique string representing the path of the documented file within the project (e.g., \"src/main/java/de/technikteam/service/UserService.java\"). This is the key used for lookups.\n        *   `content`: A `longtext` field containing the Markdown documentation for the file.\n    *   **Getters and Setters**: Standard boilerplate methods for accessing and modifying the object''s properties.');
COMMIT;